miro.onReady(() => {
    miro.initialize({
        extensionPoints: {
            toolbar: {
                title: 'Brandfetch',
                toolbarSvgIcon: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 169.63 182.37"><path fill="currentColor" d="M124.92,90.75c5.41,3.79,11.41,6.71,15.69,11.24,9.85,10.43,9.5,28.14.05,41.64-7.79,11.14-18.93,17.51-31.52,21.69-17,5.65-34.6,6.49-52.32,6.13-3-.06-6,0-9,0-3.89,8.6-10,11.89-19.91,10.69-7.07-.86-10.16-4.73-9.35-12.61,1.76-17.05,3-34.21,5.88-51.08,3.55-20.8,8.33-41.41,13-62C40,45.13,45.31,41.84,57,42.86c0.83,0.07,1.65.21,2.48,0.32,6.9,1,9,3.83,7.27,10.62-1.22,4.84-3,9.54-4.2,14.37A500.72,500.72,0,0,0,48.7,146.25c-0.07.8,0,1.62,0,2.9,17.92,1.53,35.69,2,52.52-5.27a34.79,34.79,0,0,0,12.46-9.65c9-11,4.81-26.17-8.54-31-5.7-2.06-12-2.73-18-3.55-6.72-.91-8.36-2-8.61-7.26C78.14,85.07,81.24,80,87,79.22s11.63-.94,17.36-1.92c9.94-1.7,19.44-4.76,27.24-11.55,13.05-11.37,11.05-29.61-4.53-36.92A61.74,61.74,0,0,0,107,23.44,150.45,150.45,0,0,0,17.19,42.59c-0.58.33-1.19,0.6-1.78,0.9-6.13,3-10.93,3-13.4,0C-1.13,39.59-.63,30.67,3.75,26.83A59,59,0,0,1,17,18C53.26,0.61,91.35-4.18,130.77,3.63a63.45,63.45,0,0,1,21.37,9.11c23.78,15.33,21,45.55,5.3,61.05-7.69,7.57-17.06,12-27.11,15.36C128.47,89.76,126.57,90.27,124.92,90.75Z"/></svg>',
                librarySvgIcon: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 169.63 182.37"><path d="M124.92,90.75c5.41,3.79,11.41,6.71,15.69,11.24,9.85,10.43,9.5,28.14.05,41.64-7.79,11.14-18.93,17.51-31.52,21.69-17,5.65-34.6,6.49-52.32,6.13-3-.06-6,0-9,0-3.89,8.6-10,11.89-19.91,10.69-7.07-.86-10.16-4.73-9.35-12.61,1.76-17.05,3-34.21,5.88-51.08,3.55-20.8,8.33-41.41,13-62C40,45.13,45.31,41.84,57,42.86c0.83,0.07,1.65.21,2.48,0.32,6.9,1,9,3.83,7.27,10.62-1.22,4.84-3,9.54-4.2,14.37A500.72,500.72,0,0,0,48.7,146.25c-0.07.8,0,1.62,0,2.9,17.92,1.53,35.69,2,52.52-5.27a34.79,34.79,0,0,0,12.46-9.65c9-11,4.81-26.17-8.54-31-5.7-2.06-12-2.73-18-3.55-6.72-.91-8.36-2-8.61-7.26C78.14,85.07,81.24,80,87,79.22s11.63-.94,17.36-1.92c9.94-1.7,19.44-4.76,27.24-11.55,13.05-11.37,11.05-29.61-4.53-36.92A61.74,61.74,0,0,0,107,23.44,150.45,150.45,0,0,0,17.19,42.59c-0.58.33-1.19,0.6-1.78,0.9-6.13,3-10.93,3-13.4,0C-1.13,39.59-.63,30.67,3.75,26.83A59,59,0,0,1,17,18C53.26,0.61,91.35-4.18,130.77,3.63a63.45,63.45,0,0,1,21.37,9.11c23.78,15.33,21,45.55,5.3,61.05-7.69,7.57-17.06,12-27.11,15.36C128.47,89.76,126.57,90.27,124.92,90.75Z"/></svg>',
                onClick: async () => await onToolbarAppButtonClicked()
            }
        }
    });
});

async function onToolbarAppButtonClicked() {
    const isAuthorized = await miro.isAuthorized()

    // Ask the user to authorize the app.
    if (!isAuthorized) await miro.requestAuthorization()

    // Once authorized, open the app.
    openBrandfetchApp()
}

function openBrandfetchApp() {
    miro.board.ui.openLibrary('dist/index.html', { title: 'Brandfetch' });
};
